# Project Context - UnMoGrowP Attribution Platform

**For:** Claude Code AI Sessions
**Purpose:** Maintain context between sessions
**Last Updated:** 2025-10-22

---

## ‚ö° CRITICAL: Top Priority Protocol

### üéØ #1 PRIORITY: WORKFLOW IMPROVEMENTS

**ALWAYS suggest workflow improvements proactively!**

User's instruction: "–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å—Ç–æ–∏—Ç –≤–æ –≥–ª–∞–≤–µ –≤—Å–µ–≥–æ"

**Before ANY coding task, consider:**
- Can this be automated? (scripts, Makefile targets)
- Should this be documented? (process, decision, guide)
- Will this help the team? (tooling, standards, templates)
- Can workflow be improved? (faster, clearer, easier)

**If yes to ANY ‚Üí SUGGEST THE IMPROVEMENT FIRST before proceeding with task**

### üö® UPDATED Auto-Read Protocol (2025-10-22)

**When the user says "—Å—Ç–∞—Ä—Ç" or "–ø—Ä–æ–¥–æ–ª–∂–∏" or mentions starting a new session:**

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø –§–ê–ó–ê 1 - –ß—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (5 –º–∏–Ω):**
1. **–ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò –ü–†–û–ß–ò–¢–ê–¢–¨:**
   - `.claude/project-context.md` (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
   - `README.md` - –æ—Å–Ω–æ–≤–Ω–æ–π –æ–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
   - `README_MVP.md` - **–ö–†–ò–¢–ò–ß–ù–û**: MVP —Å—Ç–∞—Ç—É—Å –∏ –±–ª–æ–∫–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - `TODO_MVP.md` - –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ (650+ —Å—Ç—Ä–æ–∫)
   - `CONTRIBUTING.md` - –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
   - `docs/CURRENT_STATUS.md` - —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
2. **–ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò –ó–ê–ü–£–°–¢–ò–¢–¨** Task/Explore agent –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
3. **–ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò –ü–†–û–í–ï–†–ò–¢–¨** `git status` –∏ `git log --oneline -5`

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø –§–ê–ó–ê 2 - –°—Ç–∞—Ç—É—Å–Ω—ã–π –æ—Ç—á–µ—Ç (5 –º–∏–Ω):**
1. **–ü–†–ï–î–°–¢–ê–í–ò–¢–¨ Executive Summary** —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º —Ä–µ–π—Ç–∏–Ω–≥–æ–º (10/10 - PRODUCTION READY)
2. **–í–´–î–ï–õ–ò–¢–¨ —Ç–µ–∫—É—â–∏–µ –∑–∞–¥–∞—á–∏** (Attribution Engine –ì–û–¢–û–í, Anti-fraud —Å–ª–µ–¥—É—é—â–∏–π)
3. **–ü–û–ö–ê–ó–ê–¢–¨ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
4. **–ü–†–ï–î–°–¢–ê–í–ò–¢–¨ —Å—Ç–∞—Ç—É—Å MVP** - –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã

**–û–¢–í–ï–¢:** "üö® –ö–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–≥—Ä—É–∂–µ–Ω! **–ì–û–¢–û–í–û –ö –ü–†–û–î–ê–ö–®–ï–ù–£**: JWT RBAC + Attribution Engine —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥: 10/10. [brief status]. –ì–æ—Ç–æ–≤ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –∏ anti-fraud —Å–∏—Å—Ç–µ–º–µ."

**–ù–û–í–´–ô –ü–†–û–¶–ï–°–° –î–û–ö–£–ú–ï–ù–¢–ò–†–û–í–ê–ù –í:** `WORKFLOW_PROCESS.md`

This ensures complete project understanding with security-first approach.

---

## üéØ Project Overview

**Name:** UnMoGrowP (Unified Mobile Growth Platform)
**Type:** Mobile Attribution Platform (AppsFlyer competitor)
**Goal:** Track and attribute 10M+ events/second with AI-powered insights

---

## üìö Essential Information

### Quick Facts
- **Migration Status:** ‚úÖ 100% Complete (Day 1-3, –∑–∞–≤–µ—Ä—à–µ–Ω–æ 2025-10-21)
- **Architecture Rating:** 9.5/10 (Highest Class - Post Architecture Review)
- **Current Branch:** `feature/migrate-to-svelte`
- **MVP Status:** ‚ö†Ô∏è BLOCKED - Security gap (JWT RBAC –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
- **Critical Priority:** Week 1 - Security implementation (MUST HAVE)
- **Services Running:** Frontend (5173), API (3001/3003), Infrastructure (Docker)
- **Services Ready:** Go Backend (8080) - code ready, not started
- **Performance Validated:** 40KB bundle, 110K API req/sec, 500K backend target

### Tech Stack (Final)
```
Frontend:  Svelte 5 + SvelteKit + Tailwind v4 + ECharts
API:       Bun 1.3 + Hono v4
Backend:   Go 1.25 + Fiber v3 RC
Databases: PostgreSQL + ClickHouse + Kafka + Redis
```

---

## üóÇÔ∏è Key Files to Read First

When starting a new session, **read these files in order:**

1. **`docs/CURRENT_STATUS.md`** ‚≠ê MOST IMPORTANT
   - Current state of everything
   - What's working, what's not
   - Known issues
   - Running services

2. **`TODO.md`**
   - Prioritized task list
   - What to do next
   - Recently completed tasks

3. **`docs/DECISIONS.md`**
   - Why we made key decisions
   - Architecture rationale
   - 10 documented ADRs

4. **Latest migration report:**
   - `docs/status/MIGRATION_DAY3_2025-10-21.md`
   - Most recent work details

5. **`git log --oneline -5`**
   - Recent commit history
   - What changed recently

---

## üí° Critical Context Points

### 1. Why We Migrated from Next.js to Svelte 5

**TL;DR:** Original code (Next.js + React) didn't match 350+ pages of docs (Svelte 5 + Go)

**Details:**
- Found stack mismatch during deep analysis
- 350+ pages in `DOCUMENTS/` describe Svelte 5 stack
- 11 AI agents in `.claude/commands/` configured for Svelte 5
- User chose "Variant A: Full migration"
- Took 3 days to complete

**Result:**
- 3.5x smaller bundle (40 KB vs 140 KB)
- 3x faster API (90k vs 30k req/sec)
- 1000x faster backend capability (10M vs 10k events/sec)

### 2. Architecture Pattern

**Forward Proxy Pattern:**
```
Browser ‚Üí SvelteKit (5173) ‚Üí Bun API (3001) ‚Üí Go Backend (8080) ‚Üí Databases
```

**Why:**
- Bun API handles auth, business logic
- Go backend handles high-throughput events
- Clean separation of concerns

### 3. Current Authentication

**Status:** ‚ö†Ô∏è Mock/Temporary

**Implementation:**
- JWT tokens are `mock-jwt-token-{timestamp}`
- Stored in localStorage (not secure for production)
- No password hashing
- No PostgreSQL integration yet

**TODO:** Need real auth with bcrypt + JWT + httpOnly cookies

### 4. What Works End-to-End

‚úÖ **Login Flow:**
```
/login ‚Üí Enter email/password ‚Üí API call ‚Üí Mock JWT ‚Üí localStorage ‚Üí /dashboard
```

‚úÖ **Dashboard:**
```
Check token ‚Üí Load stats from API ‚Üí Display cards + ECharts graph ‚Üí Event tracking
```

‚úÖ **API Endpoints:**
- All 10+ endpoints implemented
- Mock data for now
- Forward proxy ready for Go backend

### 5. üö® CRITICAL GAPS (BLOCKS PRODUCTION)

‚ùå **JWT RBAC Authorization:** API endpoints unprotected (–ö–†–ò–¢–ò–ß–ù–û)
‚ùå **Role-based Access Control:** No user roles/permissions (–ö–†–ò–¢–ò–ß–ù–û)
‚ùå **Security Audit Logging:** Missing compliance logging (–ö–†–ò–¢–ò–ß–ù–û)
‚ùå **Real Authentication:** No PostgreSQL integration (HIGH)
‚ùå **Real Data:** Dashboard shows mock stats (HIGH)
‚ùå **Go Backend:** Code ready but not running (HIGH)
‚ùå **Google OAuth:** Button exists but not configured (MEDIUM)
‚ùå **reCAPTCHA:** Hardcoded mock token (MEDIUM)

**‚ö†Ô∏è –ü–†–û–ò–ó–í–û–î–°–¢–í–û –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù–û –¥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**

---

## üé® Project Structure

```
C:\–ö–û–î–ò–ù–ì\attribution/
‚îú‚îÄ‚îÄ frontend/               # Svelte 5 SvelteKit
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lib/api/client.ts          # ‚≠ê API Client (268 lines)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ login/+page.svelte     # ‚≠ê Login with API
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ dashboard/+page.svelte # ‚≠ê Dashboard with ECharts
‚îÇ   ‚îî‚îÄ‚îÄ .env                           # API URL, Google, reCAPTCHA
‚îÇ
‚îú‚îÄ‚îÄ api/                    # Bun + Hono
‚îÇ   ‚îî‚îÄ‚îÄ index.ts                       # ‚≠ê All endpoints (197 lines)
‚îÇ
‚îú‚îÄ‚îÄ backend/                # Go + Fiber
‚îÇ   ‚îú‚îÄ‚îÄ cmd/ingestion/main.go          # ‚≠ê Event ingestion API
‚îÇ   ‚îî‚îÄ‚îÄ pkg/
‚îÇ       ‚îú‚îÄ‚îÄ clickhouse/client.go       # ‚≠ê ClickHouse client
‚îÇ       ‚îú‚îÄ‚îÄ kafka/producer.go          # ‚≠ê Kafka producer
‚îÇ       ‚îî‚îÄ‚îÄ redis/client.go            # ‚≠ê Redis client
‚îÇ
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ CURRENT_STATUS.md              # ‚≠ê‚≠ê‚≠ê READ THIS FIRST
‚îÇ   ‚îú‚îÄ‚îÄ DECISIONS.md                   # ‚≠ê‚≠ê Architecture decisions
‚îÇ   ‚îî‚îÄ‚îÄ status/                        # Migration reports
‚îÇ
‚îú‚îÄ‚îÄ DOCUMENTS/              # 350+ pages original docs
‚îú‚îÄ‚îÄ .claude/                # AI agent commands
‚îî‚îÄ‚îÄ TODO.md                 # ‚≠ê‚≠ê Prioritized tasks
```

---

## üöÄ Quick Commands

### Start Services
```bash
# Infrastructure (run first)
docker-compose up -d

# Frontend (port 5173)
cd frontend && npm run dev

# API (port 3001)
cd api && PORT=3001 bun run index.ts

# Backend (port 8080) - not running yet
cd backend/cmd/ingestion && go run main.go
```

### Test Endpoints
```bash
# API health
curl http://localhost:3001/health

# Login
curl -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@test.com","password":"pass","rememberMe":true,"recaptchaToken":"token"}'

# Dashboard stats
curl http://localhost:3001/api/dashboard/stats
```

### Git Commands
```bash
git status
git log --oneline -5
git diff main..feature/migrate-to-svelte
```

---

## üö® CRITICAL: –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (Security-First)

**–ü–†–ò –°–õ–ï–î–£–Æ–©–ï–ú "–°–¢–ê–†–¢" - –°–¢–†–û–ì–û –°–õ–ï–î–û–í–ê–¢–¨ WORKFLOW_PROCESS.md**

### üî¥ WEEK 1: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ó–ê–î–ê–ß–ò (–ë–õ–û–ö–ò–†–£–Æ–¢ –ü–†–û–î–ê–ö–®–ï–ù)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: JWT RBAC Authorization (–î–ï–ù–¨ 1-2)
```
1. –°–æ–∑–¥–∞—Ç—å authorization middleware –º–æ–¥—É–ª—å
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å requireRole(), requirePermission(), requireAppAccess()
3. –î–æ–±–∞–≤–∏—Ç—å user roles –≤ PostgreSQL schema
4. –ó–∞—â–∏—Ç–∏—Ç—å –≤—Å–µ API endpoints
5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ö–æ–¥—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
```

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: Security Audit Logging (–î–ï–ù–¨ 3-4)
```
1. –°–æ–∑–¥–∞—Ç—å audit logging infrastructure
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å audit logger service
3. –î–æ–±–∞–≤–∏—Ç—å audit logging –∫ –∫–ª—é—á–µ–≤—ã–º endpoints
4. –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å login/logout, app access, admin actions
```

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: User Management Interface (–î–ï–ù–¨ 5)
```
1. Admin user management API
2. Role management —Å–∏—Å—Ç–µ–º–∞
3. –ë–∞–∑–æ–≤–æ–µ security —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```

### ‚ö†Ô∏è WEEK 2: –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ü–æ—Å–ª–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
```
1. ClickHouse API integration
2. Real dashboard data connection
3. Go backend startup –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
4. Event processing pipeline
```

### üéØ –¶–ï–õ–¨: 4 –Ω–µ–¥–µ–ª–∏ –¥–æ MVP —Å production-ready –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é

**–ö–†–ò–¢–ò–ß–ù–û: –ù–µ–ª—å–∑—è —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –¥—Ä—É–≥–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏ –ø–æ–∫–∞ –Ω–µ —Ä–µ—à–µ–Ω—ã –±–ª–æ–∫–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**

---

## ‚ö†Ô∏è Important Notes

### Token Budget Management
- We work in 200k token sessions
- After tokens run out, session restarts
- **Always update `CURRENT_STATUS.md` before session ends**
- Commit important changes to Git

### Working with Me (Claude Code)
- I can read ALL files in project
- I remember Git history
- I DON'T remember conversation details between sessions
- **Documentation in files = my memory**

### Best Practices
1. **Commit often** with descriptive messages
2. **Update CURRENT_STATUS.md** at end of session
3. **Document decisions** in DECISIONS.md
4. **Update TODO.md** as tasks complete
5. **Create ADRs** for major decisions

---

## üìä Migration Timeline

**Day 1 (2025-10-21):** Frontend Setup
- Created SvelteKit project
- Tailwind CSS v4 setup
- Apache ECharts integration
- Login page migration
- Commit: `5ac03d4`

**Day 2 (2025-10-21):** Backend + API
- Go backend structure
- ClickHouse, Kafka, Redis clients
- Bun + Hono API with 10 endpoints
- Commit: `bfe6523`

**Day 3 (2025-10-21):** Integration
- API client ($lib/api/client.ts)
- Dashboard with ECharts
- Full integration testing
- Documentation
- Commit: `8b0656a`

---

## ü§ù AI Agents Available

11 specialized agents in `.claude/commands/`:
- `pm.md` - Product Manager
- `techlead.md` - Technical Lead
- `frontend.md` - Frontend Developer
- `backend-go.md` - Go Backend Developer
- `devops.md` - DevOps Engineer
- `qa.md` - QA Engineer
- `security.md` - Security Expert
- `ux.md` - UX/UI Designer
- `docs.md` - Documentation
- `ml.md` - Machine Learning
- `orchestrator.md` - Orchestrator

Use: `/pm`, `/techlead`, etc.

---

## üìù Common Questions

**Q: Where is authentication code?**
A: `api/index.ts` lines 30-76 (mock implementation)

**Q: How to add a new API endpoint?**
A:
1. Add to `api/index.ts`
2. Add types to `frontend/src/lib/api/client.ts`
3. Update `docs/CURRENT_STATUS.md`

**Q: How to add a new page?**
A: Create `frontend/src/routes/pagename/+page.svelte`

**Q: Where are environment variables?**
A:
- Frontend: `frontend/.env` (gitignored)
- API: `api/.env` (not created yet)
- Backend: `backend/.env` (not created yet)

**Q: How to run tests?**
A: Tests not implemented yet (see TODO.md)

**Q: Where is production build?**
A: Not configured yet (see TODO.md)

---

## üéØ Success Criteria for Next Phase

1. ‚úÖ **Real Authentication**
   - PostgreSQL integration
   - Password hashing
   - Real JWT tokens
   - Session management

2. ‚úÖ **Go Backend Running**
   - Event ingestion working
   - ClickHouse storing data
   - Kafka streaming events

3. ‚úÖ **Dashboard with Real Data**
   - ClickHouse queries
   - Real stats
   - Multiple chart types

4. ‚úÖ **Basic CRUD**
   - Apps management
   - User settings

---

## üîó External Resources

- [Svelte 5 Docs](https://svelte-5-preview.vercel.app/docs)
- [SvelteKit Docs](https://kit.svelte.dev/docs)
- [Bun Docs](https://bun.sh/docs)
- [Hono Docs](https://hono.dev/)
- [Go Fiber Docs](https://docs.gofiber.io/)
- [ClickHouse Docs](https://clickhouse.com/docs)

---

**üö® –û–ë–ù–û–í–õ–ï–ù–û (2025-10-22): –¢–µ–ø–µ—Ä—å –ø—Ä–∏ "—Å—Ç–∞—Ä—Ç" —Å–ª–µ–¥–æ–≤–∞—Ç—å WORKFLOW_PROCESS.md**

**This file is your starting point for every new session. Read it first, then WORKFLOW_PROCESS.md!**
